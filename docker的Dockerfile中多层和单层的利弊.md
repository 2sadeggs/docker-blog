#### Dockerfile中多层和单层的利弊

###### 也可以说将多个命令写到一行的利弊

构建docker镜像时，为了精简镜像的体积，一般会将RUN里的多个命令用逻辑&&运算写在一行，这样就会只生成一层镜像，如若不如此，每个RUN都会产生一层镜像，这样镜像的体积就大了起来。

实际应用中却发现了这种用法的弊端：构建验错成本太大。什么意思呢，一旦多条命令中的任何一条失败，那么镜像就要从零重新构建，这样的话如果本身RUN里边的命令很多，就会耗时很长时间去验证修改的命令是否执行成功。

但是！！！如果是分开写的话，这种情况就可以缓解，怎么说呢，如果分层写的话，一旦构建报错，首先命令少，相比于多个命令写在一起，很容易定位出问题，其次也是很nice的地方是，由于采用的分层，可以利用docker构建的缓存机制，不报错的部分直接使用缓存，能大大节约构建时间。

###### 总结：为了精简镜像尽量将多个命令写在一起，但是构建的时候为了排查问题，可以采用分层策略，将逻辑耦合的命令写在一起，然后再分层，这样能减少验错成本，节约构建时间
